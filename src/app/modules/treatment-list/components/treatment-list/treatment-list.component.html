    <fieldset class="form-sub-group">

      <mat-spinner *ngIf="showSpinner" style="margin:0 auto;"></mat-spinner>

      <legend class="legend ">{{area.areaName}} - ({{treatmentListArray.controls?.length}})</legend>

      <button type="button" mat-mini-fab color="primary" (click)="print()"><mat-icon>local_printshop</mat-icon></button>

      <div *ngIf="(rejected | async) as rejected">

        <fieldset class="form-sub-group" fxLayout="column" *ngIf="rejected.length > 0">

          <legend class="legend">Rejected</legend>

          <div *ngFor="let item of rejected">

            <div class="unaccepted-item" fxLayout="row-wrap" fxLayoutAlign="center center" fxLayoutGap="20px">

              <div class="unaccepted-form-fields">

                  <mat-form-field >
                    <input matInput placeholder="Tag number" disabled="true" [value]="item.get('Tag number')?.value">
                  </mat-form-field>

                  <mat-form-field >
                    <mat-select [value]="item.get('Treatment priority')?.value" disabled="true" placeholder="Treatment priority">
                      <mat-option [value]="2">High</mat-option>
                      <mat-option [value]="3">Medium</mat-option>
                      <mat-option [value]="4">Low</mat-option>
                    </mat-select>
                  </mat-form-field>

              </div>

              <button mat-button style="color: green" (click)="acceptMove(item)">
                <mat-icon>check_circle</mat-icon>
                Accept
            </button>

            <div fxLayout="row" fxLayoutAlign="space-between center" style="min-width: 215px !important;">

              <mat-form-field>
              <mat-select
              placeholder="Move to"
              (selectionChange)="moveOut(item)">

                <mat-option>N/A</mat-option>
                <mat-option [value]="area.areaId" *ngFor="let area of allAreas">{{ area.areaName }}</mat-option>
              </mat-select>
            </mat-form-field>

            <mat-spinner *ngIf="item.get('saving')?.value" class="saved-spinner" [diameter]="24"></mat-spinner>
            <mat-icon [@fadeSavedIcon]="item.get('saved')?.value" *ngIf="item.get('saved')?.value" class="saved-icon">check_circle</mat-icon>
            <!--<mat-icon *ngIf="!row.get('saved')?.value && !row.get('saving')?.value" class="saved-icon"></mat-icon>-->

          </div>

            </div>

          </div>

        </fieldset>
      </div>

      <div *ngIf="(admissions | async) as admissions">
          <fieldset class="form-sub-group" fxLayout="column" *ngIf="admissions.length > 0">

            <legend class="legend">Admissions</legend>

            <div *ngFor="let item of admissions">

              <div class="unaccepted-item" fxLayout="row-wrap" fxLayoutAlign="center center" fxLayoutGap="20px">

                <div class="unaccepted-form-fields">

                    <mat-form-field >
                      <input matInput placeholder="Tag number" disabled="true" [value]="item.get('Tag number')?.value">
                    </mat-form-field>

                    <mat-form-field >
                      <mat-select [value]="item.get('Treatment priority')?.value" disabled="true" placeholder="Treatment priority">
                        <mat-option [value]="2">High</mat-option>
                        <mat-option [value]="3">Medium</mat-option>
                        <mat-option [value]="4">Low</mat-option>
                      </mat-select>
                    </mat-form-field>

                </div>

                <button mat-button style="color: green" (click)="acceptMove(item)">
                  <mat-icon>check_circle</mat-icon>
                  Accept
              </button>

              <div fxLayout="row" fxLayoutAlign="space-between center" style="min-width: 215px !important;">

                <mat-form-field>
                <mat-select
                placeholder="Admit to"
                (selectionChange)="moveOut(item)">

                  <mat-option>N/A</mat-option>
                  <mat-option [value]="area.areaId" *ngFor="let area of allAreas">{{ area.areaName }}</mat-option>
                </mat-select>
              </mat-form-field>

              <mat-spinner *ngIf="item.get('saving')?.value" class="saved-spinner" [diameter]="24"></mat-spinner>
              <mat-icon [@fadeSavedIcon]="item.get('saved')?.value" *ngIf="item.get('saved')?.value" class="saved-icon">check_circle</mat-icon>
              <!--<mat-icon *ngIf="!row.get('saved')?.value && !row.get('saving')?.value" class="saved-icon"></mat-icon>-->

            </div>

              </div>

            </div>

          </fieldset>
      </div>

      <div *ngIf="(unacceptedRecords | async) as unnaccepted">

        <fieldset class="form-sub-group" fxLayout="column" *ngIf="unnaccepted.length > 0">

          <legend class="legend">Moved in</legend>

          <div *ngFor="let item of unnaccepted">

            <div class="unaccepted-item" fxLayout="row-wrap" fxLayoutAlign="center center" fxLayoutGap="20px">

              <div class="unaccepted-form-fields">

                  <mat-form-field >
                    <input matInput placeholder="Tag number" disabled="true" [value]="item.get('Tag number')?.value">
                  </mat-form-field>

                  <mat-form-field >
                    <mat-select [value]="item.get('Treatment priority')?.value" disabled="true" placeholder="Treatment priority">
                      <mat-option [value]="2">High</mat-option>
                      <mat-option [value]="3">Medium</mat-option>
                      <mat-option [value]="4">Low</mat-option>
                    </mat-select>
                  </mat-form-field>

              </div>

              <button mat-button style="color: green" (click)="acceptMove(item)">
                <mat-icon>check_circle</mat-icon>
                Accept
            </button>

            <button mat-button style="color:red" (click)="rejectMove(item)">
              <mat-icon>highlight_off</mat-icon>
              Reject
          </button>

            </div>

          </div>

        </fieldset>
      </div>

      <form [formGroup]="treatmentListForm">


              <table mat-table [dataSource]="patientRecords" formArrayName="treatmentList">


                <tr mat-header-row *matHeaderRowDef="(displayedColumns | async)"></tr>
                <tr mat-row *matRowDef="let row; let i = index; columns: (displayedColumns | async);"></tr>

                <ng-container matColumnDef="index">
                  <th mat-header-cell *matHeaderCellDef class="very-small-column"> Count </th>
                  <td mat-cell *matCellDef="let index = index" class="very-small-column"> {{index + 1}} </td>
                </ng-container>

                <ng-container matColumnDef="complete">
                  <th mat-header-cell *matHeaderCellDef class="complete-column"> Treated </th>
                  <td mat-cell *matCellDef="let row;" class="small-column">

                    <mat-chip-list>
                    <mat-chip #treatedChip="matChip" (click)="toggleTreatment(row)">
                      <mat-icon [class.is-hidden]="!row.treatedToday" class="complete">check_circle</mat-icon>
                    </mat-chip>
                  </mat-chip-list>

                  </td>
                </ng-container>

                <!--DYNAMIC FIELDS START-->

                <ng-container *ngFor="let column of ( filteredColumns | async)">

                  <ng-container [matColumnDef]="column.name">

                      <th mat-header-cell *matHeaderCellDef
                      [class.small-column]="column.name !== 'Treatment priority'"
                      [class.center-columnm]="column.name !== 'Tag number'"
                      [class.width-175]="column.name == 'Treatment priority'">
                        {{column.abbreviation || column.name}}
                      </th>

                      <td mat-cell *matCellDef="let row; let index = index;"
                      [formGroupName]="index"
                      [class.small-column]="column.name !== 'Treatment priority'"
                      [class.center-columnm]="column.name !== 'Treatment priority' && column.name !== 'Tag number'"
                      [class.width-175]="column.name == 'Treatment priority'"
                      [class.link]="column.name === 'Tag number'">

                      <div *ngIf="column.type === 'text'">
                        {{row.get(column.name).value}}
                      </div>


                      <div *ngIf="column.type === 'select'" class="width-175 start">
                        <mat-form-field>
                        <mat-select
                        [formControlName]="column.name">
                            <mat-option>N/A</mat-option>
                            <mat-option [value]="2">High</mat-option>
                            <mat-option [value]="3">Medium</mat-option>
                            <mat-option [value]="4">Low</mat-option>
                        </mat-select>
                      </mat-form-field>
                      </div>

                      <div *ngIf="column.type === 'button'">

                        <button mat-icon-button color="primary" style="cursor:pointer;" aria-label="Quick update dates"
                        (click)="quickUpdate(row.get('PatientId')?.value, row.get('Tag number')?.value)">
                            <mat-icon *ngIf="row.get('PatientStatusId')?.value < 2">event</mat-icon>
                            <div *ngIf="row.get('PatientStatusId')?.value > 1">{{row.get('PatientStatus')?.value}}</div>
                        </button>

                      </div>

                      <div *ngIf="column.type === 'checkbox'" fxLayout="column" fxLayoutAlign="center center">


                        <!--(change)="areaChanged(column?.areaId, index)"-->
                        <mat-radio-group formControlName="Moved to">
                          <mat-radio-button
                          [checked]="column?.areaId === treatmentListArray.at(index).get('Moved to')?.value"
                          [value]="column?.areaId">
                          </mat-radio-button>

                        </mat-radio-group>



                      </div>

                    </td>
                  </ng-container>

                </ng-container>

                <!--DYNAMIC FIELDS END-->

                <ng-container matColumnDef="Other">
                  <th mat-header-cell *matHeaderCellDef> Other </th>

                  <td mat-cell *matCellDef="let row; let index = index;"
                  [formGroupName]="index">

                  <div fxLayout="row" fxLayoutAlign="space-between center" style="min-width: 215px !important;">

                    <!--(selectionChange)="areaChanged($event?.value, index)"-->
                      <mat-form-field>
                      <mat-select
                      formControlName="Moved to">

                        <mat-option>N/A</mat-option>
                        <mat-option [value]="area.areaId" *ngFor="let area of otherAreas">{{ area.areaName }}</mat-option>
                      </mat-select>
                    </mat-form-field>

                    <mat-spinner *ngIf="row.get('saving')?.value" class="saved-spinner" [diameter]="24"></mat-spinner>
                    <mat-icon [@fadeSavedIcon]="row.get('saved')?.value" *ngIf="row.get('saved')?.value" class="saved-icon">check_circle</mat-icon>
                    <!--<mat-icon *ngIf="!row.get('saved')?.value && !row.get('saving')?.value" class="saved-icon"></mat-icon>-->

                  </div>

                  </td>

                </ng-container>


            </table>


    </form>

    </fieldset>

