<form [formGroup]="recordForm" autocomplete="off" (ngSubmit)="saveForm()">

  <mat-spinner class="mat-spinner" *ngIf="loading"></mat-spinner>

        <div  fxLayout="column" fxLayoutAlign="center center">
          <div fxLayout="column" fxFlex="1 1 57" fxLayoutAlign="start">
            <div class="emergencySyncIcon"  style="position: relative;margin-bottom:0px !important;">
              <mat-icon *ngIf="recordForm.dirty || (!emergencyCaseId && !syncedToLocalStorage)" matTooltip="Changes not saved">sync_disabled</mat-icon>
              <mat-icon *ngIf="!recordForm.dirty && syncedToLocalStorage" matTooltip="Changes saved locally">cloud_off</mat-icon>
              <mat-icon *ngIf="!recordForm.dirty && !syncedToLocalStorage && emergencyCaseId" style="color:seagreen" matTooltip="Changes saved to server">cloud_done</mat-icon>
            </div>
            <emergency-details
              [recordForm]="recordForm"
              [focusEmergencyNumber]="true"
              (loadEmergencyNumber)="emergencyNumberUpdated($event)"></emergency-details>

            
          </div>
          <caller-details  [recordForm]="recordForm"></caller-details>
          <div fxLayout="column" gdColumns.gt-md="1fr 1fr" fxFlex="0 1 43" fxLayoutGap="5px" fxLayoutAlign="start">

              
              <animal-selection [recordForm]="recordForm" ></animal-selection>
              <location-details [recordForm]="recordForm"></location-details>

          </div>

          <fieldset class="form-sub-group" >

            <legend class="legend">Rescue Details</legend> 
            
            <rescue-details
                [recordForm]="recordForm"
                [emergencyCaseId]="recordForm.get('emergencyDetails.emergencyCaseId')?.value">
            </rescue-details>

        </fieldset>

        <fieldset class="form-sub-group" >
          <mat-expansion-panel [expanded]="hasComments">
            <mat-expansion-panel-header>
              <mat-panel-title>
                <p class="legend">Comments</p>
              </mat-panel-title>
              <mat-panel-description>
                <p>Add Comment</p>
              </mat-panel-description>
            </mat-expansion-panel-header>
            <mat-form-field class="mat-wrapper">
              <mat-label>Comments</mat-label>
              <textarea matInput  formControlName="caseComments"></textarea>
            </mat-form-field>
          </mat-expansion-panel>
        </fieldset>


          <fieldset class="form-sub-group">

                <legend class="legend">Call Outcome</legend>

                <emergency-case-outcome [recordForm]="recordForm"></emergency-case-outcome>

          </fieldset>

          <div fxLayout="row wrap" fxLayoutGap="20px" fxLayoutAlign="center center" class="form-sub-group" >
            <button mat-raised-button color="primary" tabindex="17" type="submit" [disabled]="recordForm.invalid">Save</button>

            <button mat-raised-button color="secondary" tabindex="18" type="button" (click)="resetForm()">Reset</button>
          </div>

        </div>
</form>




