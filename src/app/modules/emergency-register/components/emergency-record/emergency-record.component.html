<form [formGroup]="recordForm" autocomplete="off" (ngSubmit)="saveForm()">

  <mat-spinner class="mat-spinner" *ngIf="loading"></mat-spinner>

        <div fxLayout="column" fxLayoutAlign="center center">
          <div fxLayout="column" fxFlex="1 1 57" fxLayoutAlign="start">

            <emergency-details
              [recordForm]="recordForm"
              [focusEmergencyNumber]="true"
              (loadEmergencyNumber)="emergencyNumberUpdated($event)"></emergency-details>

              <caller-details  [recordForm]="recordForm"></caller-details>
          </div>

          <div fxLayout="column" fxFlex="0 1 43"  fxLayoutAlign="start">

            <location-details [recordForm]="recordForm"></location-details>
            <animal-selection [recordForm]="recordForm" ></animal-selection>

          </div>
          <div fxLayout="column" fxFlex="0 1 43"  fxLayoutAlign="start">

              <fieldset class="form-sub-group">

                  <legend class="legend">Rescue Details</legend>

                  <rescue-details
                      [recordForm]="recordForm"
                      [emergencyCaseId]="recordForm.get('emergencyDetails.emergencyCaseId')?.value">
                  </rescue-details>

              </fieldset>

             

                <div fxLayout="row wrap" fxLayoutGap="20px" fxLayoutAlign="center center" class="form-sub-group">

                  <div class="emergencySyncIcon"  style="position: relative;margin-bottom: 0;">
                    <mat-icon *ngIf="recordForm.dirty || (!emergencyCaseId && !syncedToLocalStorage)" matTooltip="Changes not saved">sync_disabled</mat-icon>
                    <mat-icon *ngIf="!recordForm.dirty && syncedToLocalStorage" matTooltip="Changes saved locally">cloud_off</mat-icon>
                    <mat-icon *ngIf="!recordForm.dirty && !syncedToLocalStorage && emergencyCaseId" style="color:seagreen" matTooltip="Changes saved to server">cloud_done</mat-icon>
                  </div>

                  <button mat-raised-button color="primary" tabindex="16" type="submit" [disabled]="recordForm.invalid">Save</button>

                  <button mat-raised-button color="secondary" tabindex="17" type="button" (click)="resetForm()">Reset</button>

                  <mat-icon color="primary" class="logs_btn"
                  (click)="openLogsDialog(recordForm?.get('emergencyDetails.emergencyCaseId')?.value,recordForm?.get('emergencyDetails.emergencyNumber')?.value); $event.preventDefault();">
                    description
                  </mat-icon>
                  <div class="comment-box"  (click)="openCommentDialog(); $event.preventDefault();">
                    <div class="comment-badge">{{hasComments ? 1 : 0}}</div>
                    <mat-icon role="img" mattooltip="Add/Edit comment" color="primary" 
                    class="comment-icon "> comment </mat-icon>
                  </div>
                </div>

          </div>

        </div>
</form>



