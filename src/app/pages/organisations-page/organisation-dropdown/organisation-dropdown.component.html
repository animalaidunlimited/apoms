<fieldset class="form-sub-group" >
	<legend class="legend" i18n>{{displayedColumns[0]}}</legend>
<div class="example-container mat-elevation-z8">
	<div class="example-header">
		<mat-form-field>
			<input matInput #filter (keyup)="applyFilter($any($event.target).value)" placeholder="Filter">
			<button mat-icon-button matSuffix aria-label="clear" *ngIf="filter.value" (click)="filter.value=''; applyFilter('');">
        <mat-icon>close</mat-icon>
      </button>
		</mat-form-field>
	</div>

	<div class="add-button-container">
		<button color="primary" mat-raised-button (click)="addData($event)">
		  Add data
		</button>
	  </div>
	<mat-table #table [dataSource]="(dataSource | async)!"
	cdkDropList
	[cdkDropListData]="(dataSource | async)!"
	(cdkDropListDropped)="dropTable($event)">

		<ng-container [matColumnDef]="displayedColumns[0]">
			<mat-header-cell *matHeaderCellDef> {{displayedColumns[0]}} </mat-header-cell>
			<mat-cell *matCellDef="let element" [formGroup]="element">
				<mat-form-field floatLabel="never">
					<input  matInput [placeholder]="displayedColumns[0]" [formControlName]="textFormControlName">

				</mat-form-field>
			</mat-cell>
		</ng-container>

		<ng-container matColumnDef="SortOrder">
			<mat-header-cell *matHeaderCellDef> Sort order </mat-header-cell>
			<mat-cell *matCellDef="let element; let index = index" [formGroup]="element"> 
				<mat-form-field  floatLabel="never" style="width:45%;">
					<mat-select  formControlName="sort" placeholder="Sort order">
						<mat-option>None</mat-option>
						<mat-option *ngFor="let x of dataSource | async; let i = index;" [value]="i+1">
							{{ i + 1 }}
						</mat-option>
					</mat-select> 
					<mat-error  *ngIf="element.get('sort')?.hasError('uniqueBy')">
						Sort order should be unique
					</mat-error>
				</mat-form-field>
			</mat-cell>
		</ng-container>

		<ng-container matColumnDef="IsDeleted" style="overflow: display;">
			<mat-header-cell *matHeaderCellDef> Disabled </mat-header-cell>
			<mat-cell style="overflow:visible;" *matCellDef="let element; let i = index;"  [formGroup]="element">
				<mat-checkbox  formControlName="isDeleted" (change)='updateAble(i,$event)'> {{element.get('isDeleted')?.value ? 'disabled' : 'enabled' }}</mat-checkbox>
			</mat-cell>
		</ng-container>
		
		<ng-container matColumnDef="actions">
			<mat-header-cell  *matHeaderCellDef > Actions </mat-header-cell>
			<mat-cell *matCellDef="let element;let i = index" [formGroup]="element" >

				<button
				*ngIf="!element.disabled"
				mat-mini-fab 
				color="primary"
				[disabled]="(dataSource | async)?.values?.length === 1"
				(click)="saveRow(i,$event)">
					<mat-icon>save</mat-icon>
				</button>

				<button
				*ngIf="element.disabled"
				mat-mini-fab 
				color="primary"
				[disabled]="(dataSource | async)?.values?.length === 1"
				(click)="editRow(i,$event)">
					<mat-icon>edit</mat-icon>
				</button>

				<button
				style="margin-left: 1em;"
				mat-mini-fab 
				color="warn"
				[disabled]="(dataSource | async)?.values?.length === 1"
				(click)="removeData($event,i)">
					<mat-icon>delete</mat-icon>
				</button>

			</mat-cell>
		</ng-container>

		<ng-container matColumnDef="position">
			<th mat-header-cell *matHeaderCellDef> No. </th>
			<td mat-cell *matCellDef="let element">
			  <mat-icon style="pointer-events: all;"
			  cdkDragHandle>reorder</mat-icon>
			</td>
		  </ng-container>
		<mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
		<mat-row *matRowDef="let row; columns: displayedColumns;"  cdkDrag [cdkDragData]="row"></mat-row>
	</mat-table>
</div>


</fieldset>