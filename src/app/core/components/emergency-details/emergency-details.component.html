<fieldset [formGroup]="emergencyDetails" class="form-sub-group" autocomplete="off">

    <legend class="legend">Emergency Details</legend>

    <div fxLayout="row wrap" fxLayout.lt-md="row wrap" fxLayoutGap="10px" fxLayoutAlign="start end">

        <mat-form-field>
            <input tabindex="1" #emergencyNumber formControlName="emergencyNumber" type="number" placeholder="Em no." [errorStateMatcher]="errorMatcher" matInput>

            <mat-error *ngIf="recordForm.get('emergencyDetails.emergencyNumber')?.errors?.emergencyNumberTaken">
                The emergency number already exists.
            </mat-error>

            <mat-error *ngIf="recordForm.get('emergencyDetails.emergencyNumber')?.errors?.stuckInPending">
                Connectivity lost, please recheck
            </mat-error>

        </mat-form-field>

    <mat-form-field>
            <input tabindex="2" #callDateTimeField formControlName="callDateTime" name="callDateTime" type="datetime-local"
            [max]="callDateTime"
            [min]="minimumDate"
            [errorStateMatcher]="errorMatcher" placeholder="Call time" matInput>
    </mat-form-field>

    <mat-form-field>
        <mat-label>Dispatcher</mat-label>
        <mat-select tabindex="10" #dispatcher formControlName="dispatcher" [errorStateMatcher]="errorMatcher">
            <mat-option *ngFor="let dispatcher of dispatchers$ | async" [value]="dispatcher.UserId">
                {{dispatcher.FirstName}}
            </mat-option>
        </mat-select>
    </mat-form-field >

        <mat-form-field>
            <mat-label>Code</mat-label>
            <mat-select tabindex="9" formControlName="code" [errorStateMatcher]="errorMatcher" [compareWith]="compareEmergencyCodes" (keydown)="selectEmergencyCode($event)">

                <mat-select-trigger *ngIf="recordForm.get('emergencyDetails.code')?.value?.EmergencyCodeId">

                    <mat-icon [ngClass]="{
                        'dot-grey' : recordForm.get('emergencyDetails.code')?.value?.EmergencyCodeId == 4,
                        'dot-red' : recordForm.get('emergencyDetails.code')?.value?.EmergencyCodeId == 1,
                        'dot-green' : recordForm.get('emergencyDetails.code')?.value?.EmergencyCodeId == 2,
                        'dot-yellow' : recordForm.get('emergencyDetails.code')?.value?.EmergencyCodeId == 3}" matSuffix>fiber_manual_record</mat-icon>{{recordForm.get('emergencyDetails.code')?.value?.EmergencyCode}}</mat-select-trigger>

                <mat-option *ngFor="let code of emergencyCodes$ | async" [value]="code">

                        <mat-icon [ngClass]="{
                            'dot-grey' : code.EmergencyCodeId == 4,
                            'dot-red' : code.EmergencyCodeId == 1,
                            'dot-green' : code.EmergencyCodeId == 2,
                            'dot-yellow' : code.EmergencyCodeId == 3}" matSuffix>fiber_manual_record</mat-icon>{{code.EmergencyCode}}

                </mat-option>
            </mat-select>
        </mat-form-field>
        <!-- <button  mat-icon-button color="primary" aria-label="Release details" class="logs_btn"
          > -->
            <!-- <mat-icon color="primary" class="logs_btn" 
            (click)="openLogsDialog(recordForm?.get('emergencyDetails.emergencyCaseId')?.value,recordForm.get('emergencyDetails.emergencyNumber')); $event.preventDefault();">
              description
            </mat-icon> -->
        <!-- </button> -->

    </div>

</fieldset>